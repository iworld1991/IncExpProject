{smcl}
{com}{sf}{ul off}{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/indSCE_log.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}27 Apr 2021, 11:43:50
{txt}
{com}. 
. 
. ***************************
. **  Clean and Merge Data **
. ***************************
. 
. use "${c -(}folder{c )-}/SCE/IncExpSCEProbIndM",clear 
{txt}
{com}. 
. duplicates report year month userid

{p 0 4}{txt}Duplicates in terms of {res} year month userid{p_end}

{txt}{hline 10}{c TT}{hline 27}
   copies {c |} observations       surplus
{hline 10}{c +}{hline 27}
        1 {c |}        {res}98593             0
{txt}{hline 10}{c BT}{hline 27}

{com}. 
. 
. ************************************
. **  merge with estimated moments **
. ***********************************
. 
. * IncExpSCEDstIndM is the output from ../Pythoncode/DoDensityEst.ipynb
. merge 1:1 userid date using "${c -(}folder{c )-}/SCE/IncExpSCEDstIndM.dta", keep(master using) 
{res}{txt}{p 0 7 2}
(note: variable
date was 
float, now double to accommodate using data's values)
{p_end}

{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}         197,186
{txt}{col 9}from master{col 30}{res}          98,593{txt}  (_merge==1)
{col 9}from using{col 30}{res}          98,593{txt}  (_merge==2)

{col 5}matched{col 30}{res}               0{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge IndEst_merge
{res}{txt}
{com}. 
. rename userid ID 
{res}{txt}
{com}. 
. *******************************
. **  Set Panel Data Structure **
. *******************************
. 
. xtset ID date
{res}{txt}{col 8}panel variable:  {res}ID (unbalanced)
{txt}{col 9}time variable:  {res}{col 25}date, 2013m6 to 1.9e+12, but with gaps
{txt}{col 17}delta:  {res}1 month
{txt}
{com}. sort ID year month 
{txt}
{com}. 
. *******************************
. **  Summary Statistics of SCE **
. *******************************
. 
. tabstat ID,s(count) by(date) column(statistics)

{txt}Summary for variables: ID
{col 6}by categories of: date 

{ralign 9:date} {...}
{c |}         N
{hline 10}{c +}{hline 10}
{ralign 9: 2013m6} {...}
{c |}{...}
 {res}     1157
{txt}{ralign 9: 2013m7} {...}
{c |}{...}
 {res}     1099
{txt}{ralign 9: 2013m8} {...}
{c |}{...}
 {res}     1613
{txt}{ralign 9: 2013m9} {...}
{c |}{...}
 {res}     1403
{txt}{ralign 9:2013m10} {...}
{c |}{...}
 {res}     1416
{txt}{ralign 9:2013m11} {...}
{c |}{...}
 {res}     1408
{txt}{ralign 9:2013m12} {...}
{c |}{...}
 {res}     1241
{txt}{ralign 9: 2014m1} {...}
{c |}{...}
 {res}     1217
{txt}{ralign 9: 2014m2} {...}
{c |}{...}
 {res}     1193
{txt}{ralign 9: 2014m3} {...}
{c |}{...}
 {res}     1208
{txt}{ralign 9: 2014m4} {...}
{c |}{...}
 {res}     1208
{txt}{ralign 9: 2014m5} {...}
{c |}{...}
 {res}     1173
{txt}{ralign 9: 2014m6} {...}
{c |}{...}
 {res}     1192
{txt}{ralign 9: 2014m7} {...}
{c |}{...}
 {res}     1253
{txt}{ralign 9: 2014m8} {...}
{c |}{...}
 {res}     1228
{txt}{ralign 9: 2014m9} {...}
{c |}{...}
 {res}     1205
{txt}{ralign 9:2014m10} {...}
{c |}{...}
 {res}     1203
{txt}{ralign 9:2014m11} {...}
{c |}{...}
 {res}     1197
{txt}{ralign 9:2014m12} {...}
{c |}{...}
 {res}     1182
{txt}{ralign 9: 2015m1} {...}
{c |}{...}
 {res}     1190
{txt}{ralign 9: 2015m2} {...}
{c |}{...}
 {res}     1196
{txt}{ralign 9: 2015m3} {...}
{c |}{...}
 {res}     1165
{txt}{ralign 9: 2015m4} {...}
{c |}{...}
 {res}     1165
{txt}{ralign 9: 2015m5} {...}
{c |}{...}
 {res}     1161
{txt}{ralign 9: 2015m6} {...}
{c |}{...}
 {res}     1151
{txt}{ralign 9: 2015m7} {...}
{c |}{...}
 {res}     1135
{txt}{ralign 9: 2015m8} {...}
{c |}{...}
 {res}     1099
{txt}{ralign 9: 2015m9} {...}
{c |}{...}
 {res}     1136
{txt}{ralign 9:2015m10} {...}
{c |}{...}
 {res}     1127
{txt}{ralign 9:2015m11} {...}
{c |}{...}
 {res}     1125
{txt}{ralign 9:2015m12} {...}
{c |}{...}
 {res}     1090
{txt}{ralign 9: 2016m1} {...}
{c |}{...}
 {res}     1115
{txt}{ralign 9: 2016m2} {...}
{c |}{...}
 {res}     1065
{txt}{ralign 9: 2016m3} {...}
{c |}{...}
 {res}     1128
{txt}{ralign 9: 2016m4} {...}
{c |}{...}
 {res}     1100
{txt}{ralign 9: 2016m5} {...}
{c |}{...}
 {res}     1152
{txt}{ralign 9: 2016m6} {...}
{c |}{...}
 {res}     1151
{txt}{ralign 9: 2016m7} {...}
{c |}{...}
 {res}     1193
{txt}{ralign 9: 2016m8} {...}
{c |}{...}
 {res}     1156
{txt}{ralign 9: 2016m9} {...}
{c |}{...}
 {res}     1199
{txt}{ralign 9:2016m10} {...}
{c |}{...}
 {res}     1195
{txt}{ralign 9:2016m11} {...}
{c |}{...}
 {res}     1191
{txt}{ralign 9:2016m12} {...}
{c |}{...}
 {res}     1222
{txt}{ralign 9: 2017m1} {...}
{c |}{...}
 {res}     1222
{txt}{ralign 9: 2017m2} {...}
{c |}{...}
 {res}     1205
{txt}{ralign 9: 2017m3} {...}
{c |}{...}
 {res}     1227
{txt}{ralign 9: 2017m4} {...}
{c |}{...}
 {res}     1143
{txt}{ralign 9: 2017m5} {...}
{c |}{...}
 {res}     1212
{txt}{ralign 9: 2017m6} {...}
{c |}{...}
 {res}     1218
{txt}{ralign 9: 2017m7} {...}
{c |}{...}
 {res}     1221
{txt}{ralign 9: 2017m8} {...}
{c |}{...}
 {res}     1221
{txt}{ralign 9: 2017m9} {...}
{c |}{...}
 {res}     1196
{txt}{ralign 9:2017m10} {...}
{c |}{...}
 {res}     1245
{txt}{ralign 9:2017m11} {...}
{c |}{...}
 {res}     1214
{txt}{ralign 9:2017m12} {...}
{c |}{...}
 {res}     1157
{txt}{ralign 9: 2018m1} {...}
{c |}{...}
 {res}     1193
{txt}{ralign 9: 2018m2} {...}
{c |}{...}
 {res}     1195
{txt}{ralign 9: 2018m3} {...}
{c |}{...}
 {res}     1183
{txt}{ralign 9: 2018m4} {...}
{c |}{...}
 {res}     1160
{txt}{ralign 9: 2018m5} {...}
{c |}{...}
 {res}     1163
{txt}{ralign 9: 2018m6} {...}
{c |}{...}
 {res}     1157
{txt}{ralign 9: 2018m7} {...}
{c |}{...}
 {res}     1167
{txt}{ralign 9: 2018m8} {...}
{c |}{...}
 {res}     1174
{txt}{ralign 9: 2018m9} {...}
{c |}{...}
 {res}     1142
{txt}{ralign 9:2018m10} {...}
{c |}{...}
 {res}     1191
{txt}{ralign 9:2018m11} {...}
{c |}{...}
 {res}     1160
{txt}{ralign 9:2018m12} {...}
{c |}{...}
 {res}     1103
{txt}{ralign 9: 2019m1} {...}
{c |}{...}
 {res}     1201
{txt}{ralign 9: 2019m2} {...}
{c |}{...}
 {res}     1194
{txt}{ralign 9: 2019m3} {...}
{c |}{...}
 {res}     1210
{txt}{ralign 9: 2019m4} {...}
{c |}{...}
 {res}     1192
{txt}{ralign 9: 2019m5} {...}
{c |}{...}
 {res}     1179
{txt}{ralign 9: 2019m6} {...}
{c |}{...}
 {res}     1175
{txt}{ralign 9: 2019m7} {...}
{c |}{...}
 {res}     1179
{txt}{ralign 9: 2019m8} {...}
{c |}{...}
 {res}     1149
{txt}{ralign 9: 2019m9} {...}
{c |}{...}
 {res}     1156
{txt}{ralign 9:2019m10} {...}
{c |}{...}
 {res}     1162
{txt}{ralign 9:2019m11} {...}
{c |}{...}
 {res}     1143
{txt}{ralign 9:2019m12} {...}
{c |}{...}
 {res}     1129
{txt}{ralign 9: 2020m1} {...}
{c |}{...}
 {res}     1168
{txt}{ralign 9: 2020m2} {...}
{c |}{...}
 {res}     1171
{txt}{ralign 9: 2020m3} {...}
{c |}{...}
 {res}     1153
{txt}{ralign 9: 2020m4} {...}
{c |}{...}
 {res}     1160
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1157
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1099
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1613
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1403
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1416
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1408
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1241
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1217
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1193
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1208
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1208
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1173
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1192
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1253
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1228
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1205
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1203
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1197
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1182
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1190
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1196
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1165
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1165
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1161
{txt}{ralign 9:1.7e+08} {...}
{c |}{...}
 {res}     1151
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1135
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1099
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1136
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1127
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1125
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1090
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1115
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1065
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1128
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1100
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1152
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1151
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1193
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1156
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1199
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1195
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1191
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1222
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1222
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1205
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1227
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1143
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1212
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1218
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1221
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1221
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1196
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1245
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1214
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1157
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1193
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1195
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1183
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1160
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1163
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1157
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1167
{txt}{ralign 9:1.8e+08} {...}
{c |}{...}
 {res}     1174
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1142
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1191
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1160
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1103
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1201
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1194
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1210
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1192
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1179
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1175
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1179
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1149
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1156
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1162
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1143
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1129
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1168
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1171
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1153
{txt}{ralign 9:1.9e+08} {...}
{c |}{...}
 {res}     1160
{txt}{hline 10}{c +}{hline 10}
{ralign 9:Total} {...}
{c |}{...}
 {res}   197186
{txt}{hline 10}{c BT}{hline 10}

{com}. 
. *****************************************
. ****  Renaming so that more consistent **
. *****************************************
. 
. rename Q24_mean incmean
{res}{txt}
{com}. rename Q24_var incvar
{res}{txt}
{com}. rename Q24_iqr inciqr
{res}{txt}
{com}. rename IncSkew incskew 
{res}{txt}
{com}. rename Q24_rmean rincmean
{res}{txt}
{com}. rename Q24_rvar rincvar
{res}{txt}
{com}. 
. *rename Q36 educ
. rename D6 HHinc 
{res}{txt}
{com}. rename Q32 age 
{res}{txt}
{com}. rename Q33 gender 
{res}{txt}
{com}. rename Q10_1 fulltime
{res}{txt}
{com}. rename Q10_2 parttime
{res}{txt}
{com}. rename Q12new selfemp
{res}{txt}
{com}. rename Q6new Stkprob
{res}{txt}
{com}. rename Q4new UEprobAgg
{res}{txt}
{com}. rename Q13new UEprobInd
{res}{txt}
{com}. rename Q26v2 spending_dum
{res}{txt}
{com}. rename Q26v2part2 spending 
{res}{txt}
{com}. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. clear

. do "/Users/Myworld/Dropbox/SearchMatchExpectation/code/SCE.do"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. 
. *** labor market data
. 
. import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
{res}{txt}
{com}. 
. ********************
. *** Date format ****
. ********************
. gen date_str = string(date)
{txt}
{com}. gen year = substr(date_str,1,4)
{txt}
{com}. gen month = substr(date_str,5,2)
{txt}
{com}. gen date2=year+"m"+month
{txt}
{com}. gen date3= monthly(date2,"YM")
{txt}
{com}. format date3 %tm
{txt}
{com}. drop date_str date2 date
{txt}
{com}. rename date3 date
{res}{txt}
{com}. destring year, replace
{txt}year has all characters numeric; {res}replaced {txt}as {res}int
{txt}
{com}. destring month, replace 
{txt}month has all characters numeric; {res}replaced {txt}as {res}byte
{txt}
{com}. order date year month
{txt}
{com}. xtset userid date
{res}{txt}{col 8}panel variable:  {res}userid (unbalanced)
{txt}{col 9}time variable:  {res}{col 25}date, 2014m3 to 2019m3, but with gaps
{txt}{col 17}delta:  {res}1 month
{txt}
{com}. 
. 
. label var l1m "starting month of current/main job"
{txt}
{com}. label var l1y "starting year of current/main job"
{txt}
{com}. label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
{txt}
{com}. label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
{txt}note: label truncated to 80 characters

{com}. label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
{txt}
{com}. label var lmtype "employer type of current/main"
{txt}
{com}. label var lmtype_5_other "employer type (others)"
{txt}
{com}. label var lmind "business/industry of current employer"
{txt}
{com}. label var lm5_1 "employer benefits: pension plan"
{txt}
{com}. label var lm5_2 "employer benefits: pension plan"
{txt}
{com}. label var lm5_3  "employer benefits: health insurance"
{txt}
{com}. label var lm5_4 "employer benefits: dental/vision insurance"
{txt}
{com}. label var lm5_5  "employer benefits: health care or dependent care"
{txt}
{com}. label var lm5_6  "employer benefits: housing/husing subsidy"
{txt}
{com}. label var lm5_7  "employer benefits: life/disability insurance"
{txt}
{com}. label var lm5_8 "employer benefits: commuter benefits"
{txt}
{com}. label var lm5_9 "employer benefits: childcare assistance"
{txt}
{com}. label var lm5_10 "employer benefits: other"
{txt}
{com}. label var lm5_10_other "employer benefits: other specified"
{txt}
{com}. label var lm5_11 "employer benefits: none"
{txt}
{com}. label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
{txt}
{com}. label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
{txt}
{com}. label var lmsat3 "fit with the job (1-7 more fit)"
{txt}
{com}. label var lmsat4 "opportunity for promotion/progression from y to y+3"
{txt}
{com}. label var lmsat5 "overall satisfication (1-5 more satisfied)"
{txt}
{com}. label var l7m "last month of the most recent job"
{txt}
{com}. label var l7y "last year of the most recent job"
{txt}
{com}. label var l7dk_1 "never had a paid job"
{txt}
{com}. label var l7bm "starting month of the most recent job"
{txt}
{com}. label var l7by "starting year of the most recent job"
{txt}
{com}. label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
{txt}
{com}. label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
{txt}
{com}. label var l11 "work for someone(1) or self-employment (2)"
{txt}
{com}. label var l12 "employer type of most recent job"
{txt}
{com}. label var l12_5_other "employer type of most recent job (other)"
{txt}
{com}. label var l12b "business/industry of the most recent job"
{txt}
{com}. label var l13_1 "employer benefits most recent job: pension plans"
{txt}
{com}. label var l13_2 ""
{txt}
{com}. label var l13_3 ""
{txt}
{com}. label var l13_4 ""
{txt}
{com}. label var l13_5 ""
{txt}
{com}. label var l13_6 ""
{txt}
{com}. label var l13_7 ""
{txt}
{com}. label var l13_8 ""
{txt}
{com}. label var l13_9 ""
{txt}
{com}. label var l13_10 ""
{txt}
{com}. label var l13_11 ""
{txt}
{com}. label var l13_10_other ""
{txt}
{com}. label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
{txt}
{com}. label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
{txt}
{com}. label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
{txt}
{com}. label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
{txt}note: label truncated to 80 characters

{com}. label var js7 "nb of weeks looking for a job"
{txt}
{com}. label var js8_1 "things done to look for a job"
{txt}
{com}. label var js8_2 ""
{txt}
{com}. label var js8_3 ""
{txt}
{com}. label var js8_4 ""
{txt}
{com}. label var js8_5 ""
{txt}
{com}. label var js8_6 ""
{txt}
{com}. label var js8_7 ""
{txt}
{com}. label var js8_8 ""
{txt}
{com}. label var js8_9 ""
{txt}
{com}. label var js8_10 ""
{txt}
{com}. label var js8_11 ""
{txt}
{com}. label var js8_12 ""
{txt}
{com}. label var js8_13 ""
{txt}
{com}. label var js8_14 ""
{txt}
{com}. label var js8_14_other
{txt}
{com}. label var js9 "nb of hours spent on job search from d-7 to d"
{txt}
{com}. label var nl1 "nb of job offers received from m-4 to m"
{txt}
{com}. label var nl2a_1 ""
{txt}
{com}. label var nl2a_2 ""
{txt}
{com}. label var nl2a_3 ""
{txt}
{com}. label var nl2b_1 ""
{txt}
{com}. label var nl2b_2 ""
{txt}
{com}. label var nl2b_3 ""
{txt}
{com}. label var nl3_1 "currently working at the accepted job"
{txt}
{com}. label var nl3_2 "once worked at the accepted job"
{txt}
{com}. label var nl3_3 "rejected the job offer"
{txt}
{com}. label var nl4_1 ""
{txt}
{com}. label var nl4_2 ""
{txt}
{com}. label var nl4_3 "" 
{txt}
{com}. label var oo1_1 "expected prob of employed from m to m+4" 
{txt}
{com}. label var oo1_2 "expected prob of employed by same employer from m to m+4" 
{txt}
{com}. label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
{txt}
{com}. label var oo1_4 "expected prob of self-employed from m to m+4" 
{txt}
{com}. label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
{txt}
{com}. label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
{txt}
{com}. label var oo2u "expected prob of receing >1 job offer from m to m+4" 
{txt}
{com}. label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
{txt}
{com}. label var oo2new "expected nb of job offers received from m to m+4" 
{txt}
{com}. label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
{txt}
{com}. label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
{txt}
{com}. label var oo2b_1 ""
{txt}
{com}. label var oo2b_2 ""
{txt}
{com}. label var oo2b_3 ""
{txt}
{com}. label var oo2b_4 ""
{txt}
{com}. label var oo2b_5 ""
{txt}
{com}. label var oo2b_6 ""
{txt}
{com}. label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
{txt}
{com}. label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
{txt}
{com}. label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
{txt}
{com}. label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
{txt}
{com}. label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
{txt}
{com}. label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
{txt}
{com}. label var oo2e2 "expected earning in m+4 (in $)"
{txt}
{com}. label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
{txt}
{com}. label var oo2f ""
{txt}
{com}. label var q113 ""
{txt}
{com}. label var q115 ""
{txt}
{com}. label var q117 "planed retirement age"
{txt}
{com}. label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
{txt}
{com}. label var q119 "nb of years earlier before retirement than planed"
{txt}
{com}. label var q120  "nb of years later before retirement than planed"
{txt}
{com}. label var q121  ""
{txt}
{com}. label var q122 ""
{txt}
{com}. 
. 
. save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
{txt}file /Users/Myworld/Dropbox/SearchMatchExpectation//data/SCE/LaborExpSCEIndM.dta saved

{com}. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "/var/folders/k3/fzq0vzzx2b56ypvhsddgs7hr0000gn/T//SD01766.000000"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> */
. 
. ***************************************************
. **** subselect variables from core module of SCE ***
. ****************************************************
. 
. use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
{txt}
{com}. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. table Q48

{txt}{hline 10}{c TT}{hline 11}
interesti {c |}
ng/uninte {c |}
resting   {c |}
of the    {c |}
questions {c |}
in the    {c |}
survey(1/ {c |}
0)        {c |}      Freq.
{hline 10}{c +}{hline 11}
        1 {c |}      {res}3,764
        {txt}2 {c |}      {res}8,318
        {txt}3 {c |}     {res}17,698
        {txt}4 {c |}     {res}49,752
        {txt}5 {c |}     {res}19,047
{txt}{hline 10}{c BT}{hline 11}

{com}. clear

. do "/var/folders/k3/fzq0vzzx2b56ypvhsddgs7hr0000gn/T//SD01766.000000"
{txt}
{com}. ****************************************************
. ***   This do files cleans SCE individual density **
. ***   forecasts and moments. It exclude the top and *
. ***   bottom 5 percentiles of mean and uncertainty. *
. ***   It also plots histograms of mean forecast and *
. ***   uncertainty. **********************************
. *****************************************************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/SurveyData/"
{txt}
{com}. global otherfolder "${c -(}mainfolder{c )-}/OtherData/"
{txt}
{com}. global sum_graph_folder "${c -(}mainfolder{c )-}/Graphs/pop"
{txt}
{com}. global sum_table_folder "${c -(}mainfolder{c )-}/Tables"
{txt}
{com}. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. set more off 
{txt}
{com}. 
. 
. use "${c -(}folder{c )-}/SCE/NYFED_SCE_13_16.dta",clear
{err}{p 0 4 2}
file /Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData//SCE/NYFED_SCE_13_16.dta
not found
{p_end}
{txt}{search r(601):r(601);}

end of do-file

{search r(601):r(601);}

{com}. do "/var/folders/k3/fzq0vzzx2b56ypvhsddgs7hr0000gn/T//SD01766.000000"
{txt}
{com}. ****************************************************
. ***   This do files cleans SCE individual density **
. ***   forecasts and moments. It exclude the top and *
. ***   bottom 5 percentiles of mean and uncertainty. *
. ***   It also plots histograms of mean forecast and *
. ***   uncertainty. **********************************
. *****************************************************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/SurveyData/"
{txt}
{com}. global data_folder "/Users/Myworld/Dropbox/ExpProject/workingfolder/SurveyData/SCE/"
{txt}
{com}. global otherfolder "${c -(}mainfolder{c )-}/OtherData/"
{txt}
{com}. global sum_graph_folder "${c -(}mainfolder{c )-}/Graphs/pop"
{txt}
{com}. global sum_table_folder "${c -(}mainfolder{c )-}/Tables"
{txt}
{com}. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. set more off 
{txt}
{com}. 
. 
. use "${c -(}folder{c )-}/SCE/NYFED_SCE_13_16.dta",clear
{err}{p 0 4 2}
file /Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData//SCE/NYFED_SCE_13_16.dta
not found
{p_end}
{txt}{search r(601):r(601);}

end of do-file

{search r(601):r(601);}

{com}. do "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/DoFile/Step01_CleaningSCE.do"
{txt}
{com}. ****************************************************
. ***   This do files cleans SCE individual density **
. ***   forecasts and moments. It exclude the top and *
. ***   bottom 5 percentiles of mean and uncertainty. *
. ***   It also plots histograms of mean forecast and *
. ***   uncertainty. **********************************
. *****************************************************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/SurveyData/"
{txt}
{com}. global data_folder "/Users/Myworld/Dropbox/ExpProject/workingfolder/SurveyData/SCE/"
{txt}
{com}. global otherfolder "${c -(}mainfolder{c )-}/OtherData/"
{txt}
{com}. global sum_graph_folder "${c -(}mainfolder{c )-}/Graphs/pop"
{txt}
{com}. global sum_table_folder "${c -(}mainfolder{c )-}/Tables"
{txt}
{com}. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. set more off 
{txt}
{com}. 
. 
. use "${c -(}datafolder{c )-}NYFED_SCE_13_16.dta",clear
{err}{p 0 4 2}
file NYFED_SCE_13_16.dta
not found
{p_end}
{txt}{search r(601):r(601);}

end of do-file

{search r(601):r(601);}

{com}. do "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/DoFile/Step01_CleaningSCE.do"
{txt}
{com}. ****************************************************
. ***   This do files cleans SCE individual density **
. ***   forecasts and moments. It exclude the top and *
. ***   bottom 5 percentiles of mean and uncertainty. *
. ***   It also plots histograms of mean forecast and *
. ***   uncertainty. **********************************
. *****************************************************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/SurveyData/"
{txt}
{com}. global data_folder "/Users/Myworld/Dropbox/ExpProject/workingfolder/SurveyData/SCE/"
{txt}
{com}. global otherfolder "${c -(}mainfolder{c )-}/OtherData/"
{txt}
{com}. global sum_graph_folder "${c -(}mainfolder{c )-}/Graphs/pop"
{txt}
{com}. global sum_table_folder "${c -(}mainfolder{c )-}/Tables"
{txt}
{com}. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. set more off 
{txt}
{com}. 
. 
. use "${c -(}data_folder{c )-}NYFED_SCE_13_16.dta",clear
{txt}
{com}. append using "${c -(}data_folder{c )-}NYFED_SCE_17_19.dta",force
{txt}{p 0 7 2}
(note: variable
Q3 was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q4new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q5new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q6new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q14new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q22new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q30new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q32 was 
int, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
DHH2_11_other was 
str48, now str83 to accommodate using data's values)
{p_end}

{com}. append using  "${c -(}data_folder{c )-}NYFED_SCE_20.dta",force
{txt}
{com}. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/DoFile/Step01_CleaningSCE.do"
{txt}
{com}. ****************************************************
. ***   This do files cleans SCE individual density **
. ***   forecasts and moments. It exclude the top and *
. ***   bottom 5 percentiles of mean and uncertainty. *
. ***   It also plots histograms of mean forecast and *
. ***   uncertainty. **********************************
. *****************************************************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/SurveyData/"
{txt}
{com}. global data_folder "/Users/Myworld/Dropbox/ExpProject/workingfolder/SurveyData/SCE/"
{txt}
{com}. global otherfolder "${c -(}mainfolder{c )-}/OtherData/"
{txt}
{com}. global sum_graph_folder "${c -(}mainfolder{c )-}/Graphs/pop"
{txt}
{com}. global sum_table_folder "${c -(}mainfolder{c )-}/Tables"
{txt}
{com}. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData
{txt}
{com}. set more off 
{txt}
{com}. 
. 
. use "${c -(}data_folder{c )-}NYFED_SCE_13_16.dta",clear
{txt}
{com}. append using "${c -(}data_folder{c )-}NYFED_SCE_17_19.dta",force
{txt}{p 0 7 2}
(note: variable
Q3 was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q4new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q5new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q6new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q14new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q22new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q30new was 
byte, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
Q32 was 
int, now double to accommodate using data's values)
{p_end}
{p 0 7 2}
(note: variable
DHH2_11_other was 
str48, now str83 to accommodate using data's values)
{p_end}

{com}. append using  "${c -(}data_folder{c )-}NYFED_SCE_20.dta",force
{txt}
{com}. 
. sort date
{txt}
{com}. unique userid
{txt}Number of unique values of userid is  {res}15499
{txt}Number of records is  {res}109372
{txt}
{com}. 
. ********************
. *** Date format ****
. ********************
. gen date_str = string(date)
{txt}
{com}. gen year = substr(date_str,1,4)
{txt}
{com}. gen month = substr(date_str,5,2)
{txt}
{com}. gen date2=year+"m"+month
{txt}
{com}. gen date3= monthly(date2,"YM")
{txt}
{com}. format date3 %tm
{txt}
{com}. drop date_str date2 date
{txt}
{com}. rename date3 date
{res}{txt}
{com}. destring year, replace
{txt}year has all characters numeric; {res}replaced {txt}as {res}int
{txt}
{com}. destring month, replace 
{txt}month has all characters numeric; {res}replaced {txt}as {res}byte
{txt}
{com}. order date year month
{txt}
{com}. xtset userid date
{res}{txt}{col 8}panel variable:  {res}userid (unbalanced)
{txt}{col 9}time variable:  {res}{col 25}date, 2013m6 to 2020m4, but with gaps
{txt}{col 17}delta:  {res}1 month
{txt}
{com}. 
. **********************
. ** Label variables ***
. **********************
. 
. label var Q1 "finance better or worse(5 vals) from y-1 to y"
{txt}
{com}. label var Q2 "finance better or worse(5 vals) from y to y+1"
{txt}
{com}. label var Q3 "chance of moving (%)"
{txt}
{com}. label var Q4new "chance of UE higher from y to y+1(0-1)"
{txt}
{com}. label var Q5new "chance of saving interest rate higher from y to y+1(%)"
{txt}
{com}. label var Q6new "chance of stock market up from y to y+1(%)"
{txt}
{com}. label var Q8v2 "inflation or deflation from y to y+1 (1/0)"
{txt}
{com}. label var Q8v2part2 "inflation(or deflation) from y to y+1 (%) "
{txt}
{com}. label var Q9_cent25 "25 percentile of inflation from y to y+1(%)"
{txt}
{com}. label var Q9_cent50 "50 percentile of inflation from y to y+1(%)"
{txt}
{com}. label var Q9_cent75 "75 percentile of inflation from y to y+1(%)"
{txt}
{com}. label var Q9_var "var of inflation from y to y+1"
{txt}
{com}. label var Q9_iqr "25/75 inter-quantile range of inflation from y to y+1(%)"
{txt}
{com}. label var Q9_mean "mean of inflation from y to y+1(%)"
{txt}
{com}. label var Q9_probdeflation "prob of deflation from y to y+1 (0-1)"
{txt}
{com}. label var Q9_bin1 "density: >12% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin2 "density: 8%-12% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin3 "density: 4%-8% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin4 "density: 2%-4% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin5 "density: 0%-2% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin6 "density: -2%-0% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin7 "density: -4%- -2% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin8 "density: -8%--4% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin9 "density: -12%- -8% inflation from y to y+1(%)"
{txt}
{com}. label var Q9_bin10 "density: <-12% inflation from y to y+1(%)"
{txt}
{com}. label var Q9bv2 "inflation or deflation from y+1 to y+2 (1/0)"
{txt}
{com}. label var Q9bv2part2 "inflation(or deflation) from y+1 to y+2 (%)"
{txt}
{com}. label var Q9c_cent25 "25 percentile of inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_cent50 "50 percentile of inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_cent75 "75 percentile of inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_var "var of inflation from y+1 to y+2"
{txt}
{com}. label var Q9c_mean "mean of inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_iqr "25/75 inter-quantile range of inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_probdeflation "prob of deflation from y+1 to y+2 (0-1)"
{txt}
{com}. label var Q9c_bin1 "density: >12% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin2 "density: 8%-12% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin3 "density: 4%-8% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin4 "density: 2%-4% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin5 "density: 0%-2% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin6 "density: -2%-0% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin7 "density: -4%- -2% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin8 "density: -8%--4% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin9 "density: -12%- -8% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q9c_bin10 "density: <-12% inflation from y+1 to y+2(%)"
{txt}
{com}. label var Q10_1 "current emp situations:full-time"
{txt}
{com}. label var Q10_2 "current emp situations:part-time"
{txt}
{com}. label var Q10_3 "current emp situations: not working but wants to work"
{txt}
{com}. label var Q10_4 "current emp situations: temporary laid-off"
{txt}
{com}. label var Q10_5 "current emp situations: on sick or other leave"
{txt}
{com}. label var Q10_6 "current emp situations: permanently disabled/unable to work"
{txt}
{com}. label var Q10_7 "current emp situations: retiree or early retiree"
{txt}
{com}. label var Q10_8 "current emp situations: student or in training"
{txt}
{com}. label var Q10_9 "current emp situations: homemaker"
{txt}
{com}. label var Q10_10 "current emp situations: others"
{txt}
{com}. label var Q11 "number of jobs"
{txt}
{com}. label var Q12new "work for someone or self-employed(1/0)"
{txt}
{com}. label var ES1_1 ""
{txt}
{com}. label var ES1_2 ""
{txt}
{com}. label var ES1_3 ""
{txt}
{com}. label var ES1_4 ""
{txt}
{com}. label var ES2 ""
{txt}
{com}. label var ES3new ""
{txt}
{com}. label var ES4 ""
{txt}
{com}. label var ES5 ""
{txt}
{com}. label var Q13new "chance of losing job from y to y+1(%)"
{txt}
{com}. label var Q14new "chance of voluntarily leaving the job from y to y+1(%)"
{txt}
{com}. label var Q15 "currently looking for a job (1/0)"
{txt}
{com}. label var Q16 "duration of unemployment (months)"
{txt}
{com}. label var Q17new "chance of finding and accepting a job from y to y+1(%)"
{txt}
{com}. label var Q18new "chance of finding and accepting a job from m to m+3"
{txt}
{com}. label var Q19 "duration of out of work(%)"
{txt}
{com}. label var Q20new "chance of starting looking for a job from y to y+1(%)"
{txt}
{com}. label var Q21new "chance of starting looking for a job from m to m+3(%)"
{txt}
{com}. label var Q22new "chance of finding a new job if losing the current one within 3 months"
{txt}
{com}. label var Q23v2 "earning increase/decrease from the same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q23v2part2 "change of earning from the same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_cent25 "25 percentile of earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_cent50 "50 percentile of earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_cent75 "75 percentile of earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_var "var of earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_mean "mean of earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_iqr "25/75 inter-quantile range of earning growth of same job/time/place from y to y+1(%)"
{txt}note: label truncated to 80 characters

{com}. label var Q24_probdeflation "???"
{txt}
{com}. label var Q24_bin1 ">12% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin2 "8%-12% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin3 "4%-8% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin4 "2%-4% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin5 "0-2% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin6 "-2%-0 earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin7 "-4%- -2% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin8 "-8% - -4% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin9 "-12%- -8% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q24_bin10 "<-12% earning growth of same job/time/place from y to y+1(%)"
{txt}
{com}. label var Q25v2 "increase/decrease of total household income from y to y+1(1/0)"
{txt}
{com}. label var Q25v2part2 "increase of total household income from y to y+1(%)"
{txt}
{com}. label var Q26v2 "increase/decrease of total household spending from y to y+1(1/0)"
{txt}
{com}. label var Q26v2part2 "increase of total household spending from y to y+1(%)"
{txt}
{com}. label var Q27v2 "increase/decrease of total household tax payment given the same income (1/0)"
{txt}
{com}. label var Q27v2part2 "increase of total household tax payment given the same income (%)"
{txt}
{com}. label var Q28 "easier/harder to get credit/loan from y-1 to y(1-5)"
{txt}
{com}. label var Q29 "easier/harder to get credit/loan from y to y+1(1-5)"
{txt}
{com}. label var Q30new "chance of non-payment of debt from m to m+3(%)"
{txt}
{com}. label var Q31v2 "increase/decrease of nationwide house price(1/0)"
{txt}
{com}. label var Q31v2part2 "increase of nationwide house price(%)"
{txt}
{com}. label var C1_cent25 "25 percentile of increase of nationwide house price(%)"
{txt}
{com}. label var C1_cent50 "50 percentile of increase of nationwide house price(%)"
{txt}
{com}. label var C1_cent75 "75 percentile of increase of nationwide house price(%)"
{txt}
{com}. label var C1_var "var of increase of nationwide house price"
{txt}
{com}. label var C1_mean "mean of increase of nationwide house price(%)"
{txt}
{com}. label var C1_iqr "25/75 inter-quantile range  of increase of nationwide house price(%)"
{txt}
{com}. label var C1_probdeflation "??"
{txt}
{com}. label var C1_bin1 ">12% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin2 "8%-12% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin3 "4%-8% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin4 "2%-4% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin5 "0-2% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin6 "-2%-0% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin7 "-4%- -2% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin8 "-8%- -4% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin9 "-12%- -8% increase in nationwide house price(%)"
{txt}
{com}. label var C1_bin10 "<-12% increase in nationwide house price(%)"
{txt}
{com}. label var C2 "increase/decrease in nationwide house price from y+1 to y+2(1/0)"
{txt}
{com}. label var C2part2 "increase in nationwide house price from y+1 to y+2(%)"
{txt}
{com}. label var C3 "increase/decrease of U.S. gov debt from y to y+1(1/0)"
{txt}
{com}. label var C3part2"increase of U.S. gov debt from y to y+1(%)"
{txt}
{com}. label var C4_1 "increase of a gallon of gas from y to y+1(%)"
{txt}
{com}. label var C4_2 "increase of food price from y to y+1(%)"
{txt}
{com}. label var C4_3 "increase of a medical care from y to y+1(%)"
{txt}
{com}. label var C4_4 "increase of college education from y to y+1(%)"
{txt}
{com}. label var C4_5 "increase of price of renting a typical house/apt from y to y+1(%)"
{txt}
{com}. label var C4_6  "increase of gold price from y to y+1(%)"
{txt}
{com}. label var QNUM1 "num q 1: (correct if ==150)"
{txt}
{com}. label var QNUM2 "num q 2: (correct if ==242)"
{txt}
{com}. label var QNUM3 "num q 3: (correct if ==10)"
{txt}
{com}. label var QNUM5 "num q 5: (correct if ==100)"
{txt}
{com}. label var QNUM6 "num q 6: (correct if ==5)"
{txt}
{com}. label var QNUM8 "num q 8: (correct if ==3)"
{txt}
{com}. label var QNUM9 "num q 9: (correct if ==2)"
{txt}
{com}. label var Q32 "age(in years)"
{txt}
{com}. label var Q33 "gender"
{txt}
{com}. label var Q34 "hispanic/latino/spanish(1/0)"
{txt}
{com}. label var Q35_1 "race: white"
{txt}
{com}. label var Q35_2 "race: black/african american"
{txt}
{com}. label var Q35_3 "race: american indian/alaska native"
{txt}
{com}. label var Q35_4 "race: asian"
{txt}
{com}. label var Q35_5 "race: native hawaiian or other pacific islander"
{txt}
{com}. label var Q35_6 "race: other"
{txt}
{com}. label var Q36 "education (1-8 low to high, 9 other)"
{txt}
{com}. label var Q37 "months of current work"
{txt}
{com}. label var Q38 "living with partner/not (1/0)"
{txt}
{com}. label var HH2_1 "emp of partner: full-time for someone"
{txt}
{com}. label var HH2_2 "emp of partner: part-time for someone"
{txt}
{com}. label var HH2_3 "emp of partner: self-employed"
{txt}
{com}. label var HH2_4 "emp of partner: not working but wants to work"
{txt}
{com}. label var HH2_5 "emp of partner: temporary laid-off"
{txt}
{com}. label var HH2_6 "emp of partner: on sick or other leave"
{txt}
{com}. label var HH2_7 "emp of partner: permanently disabled/unable to work"
{txt}
{com}. label var HH2_8 "emp of partner: retiree or early retiree"
{txt}
{com}. label var HH2_9 "emp of partner: student or in training"
{txt}
{com}. label var HH2_10 "emp of partner: homemaker"
{txt}
{com}. label var HH2_10 "emp of partner: other"
{txt}
{com}. label var _STATE "state (2-digit code)"
{txt}
{com}. label var Q41 "years of living in the current residence"
{txt}
{com}. label var Q42 "years of living in the current states"
{txt}
{com}. label var Q43 "own/rent/other a house(1/2/3)"
{txt}
{com}. label var Q43a "my/spounser/both's name under which current residence is owned/rent"
{txt}
{com}. label var Q44 "own other homes(1/0)"
{txt}
{com}. label var Q45b "health condition(1-5 from good to poor)"
{txt}
{com}. label var Q45new_1 ""
{txt}
{com}. label var Q45new_2 ""
{txt}
{com}. label var Q45new_3 ""
{txt}
{com}. label var Q45new_4 ""
{txt}
{com}. label var Q45new_5 ""
{txt}
{com}. label var Q45new_6 ""
{txt}
{com}. label var Q45new_7 ""
{txt}
{com}. label var Q45new_8 ""
{txt}
{com}. label var Q45new_9 ""
{txt}
{com}. label var Q46 "financial decision making of household(1-5, together to individual)"
{txt}
{com}. label var Q47 "total pre-tax household income from y-1 to y(1-11, low to high)"
{txt}
{com}. label var D1 "same household as last year(1/0)"
{txt}
{com}. label var D3 "date of moving to the current residence(month/year)"
{txt}
{com}. label var D6 "total pre-tax household income from y-1 to y(1-11,low to high)"
{txt}
{com}. label var D2new_1 "memeber in the current resident:spounse/partner"
{txt}
{com}. label var D2new_2 "memeber in the current resident: child >25"
{txt}
{com}. label var D2new_3 "memeber in the current resident: child 18-24"
{txt}
{com}. label var D2new_4 "memeber in the current resident: child 6-17"
{txt}
{com}. label var D2new_5 "memeber in the current resident: child <=5 "
{txt}
{com}. label var D2new_6 "memeber in the current resident: own/sponse's parents"
{txt}
{com}. label var D2new_7 "memeber in the current resident:other relatives"
{txt}
{com}. label var D2new_8 "memeber in the current resident:non-relatives"
{txt}
{com}. label var DSAME "same job as last year in survey"
{txt}
{com}. label var DQ38 "living as a partner or married with some one(1/0)"
{txt}
{com}. label var Q48 "interesting/uninteresting of the questions in the survey(1/0)"
{txt}
{com}. 
. 
. ** Only keep useful variables so that the data file is smaller. 
. 
. global keeplist date year month userid tenure weight ///        
>        Q24_cent25 Q24_cent50 Q24_cent75 Q24_var Q24_mean Q24_iqr ///
>            Q24_bin1 Q24_bin2 Q24_bin3 Q24_bin4 Q24_bin5 Q24_bin6 Q24_bin7 Q24_bin8 Q24_bin9 Q24_bin10 ///
>            Q32 Q33 Q34 Q35_1 Q35_2 Q35_3 Q35_4 Q35_5 Q35_6 Q36 Q37 Q38 ///
>            HH2_1 HH2_2 HH2_3 HH2_4 HH2_5 HH2_6 HH2_7 HH2_8 HH2_9 HH2_10 HH2_11 ///
>            _STATE Q41 Q42 Q43 Q43a Q44 Q45b ///
>            Q45new_1 Q45new_2 Q45new_3 Q45new_4 Q45new_5 Q45new_6 Q45new_7 Q45new_8 Q45new_9 ///
>            Q46 Q47 D1 D3 D6 D2new_1 D2new_2 D2new_3 D2new_4 D2new_5 D2new_6 D2new_7 D2new_8 D2new_9 DSAME DQ38 ///
>            DHH2_1 DHH2_2 DHH2_3 DHH2_4 DHH2_5 DHH2_6 DHH2_7 DHH2_8 DHH2_9 DHH2_10 DHH2_11 DHH2_11_other D5b Q48 QRA1 QRA2 ///
>            _AGE_CAT _NUM_CAT _REGION_CAT _COMMUTING_ZONE _EDU_CAT _HH_INC_CAT ///
>            Q1 Q2 Q3 Q4new Q5new Q6new Q9_mean Q9_var ///
>            Q10_1 Q10_2 Q10_3 Q10_4 Q10_5 Q10_6 Q10_7 Q10_8 Q10_9 Q10_10 Q11 Q12new Q13new Q14new ///
>            Q25v2 Q25v2part2 Q31v2 Q31v2part2 C1_mean C1_var ///
>            Q26v2 Q26v2part2 QNUM1 QNUM2 QNUM3 QNUM5 QNUM6 QNUM8 QNUM9  ///
>            Q17new Q18new Q19 Q20new Q21new Q22new 
{txt}
{com}.  
. keep ${c -(}keeplist{c )-}
{txt}
{com}. 
. *************************
. *** Merge with state level 
. *************************
. 
. rename _STATE state 
{res}{txt}
{com}. 
. 
. merge m:1 state using "${c -(}otherfolder{c )-}statecode.dta"
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}             201
{txt}{col 9}from master{col 30}{res}             200{txt}  (_merge==1)
{col 9}from using{col 30}{res}               1{txt}  (_merge==2)

{col 5}matched{col 30}{res}         109,172{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge state_code_merge 
{res}{txt}
{com}. 
. merge m:1 statecode year month using "${c -(}otherfolder{c )-}stateM.dta",keep(master match) 
{res}{txt}{p 0 7 2}
(note: variable
month was 
byte, now float to accommodate using data's values)
{p_end}
(label _merge already defined)

{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}          13,187
{txt}{col 9}from master{col 30}{res}          13,187{txt}  (_merge==1)
{col 9}from using{col 30}{res}               0{txt}  (_merge==2)

{col 5}matched{col 30}{res}          96,186{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge stateM_merge 
{res}{txt}
{com}. 
. *************************
. *** Exclude outliers ****
. *************************
. 
. local Moments Q24_mean Q24_var Q9_mean Q9_var 
{txt}
{com}. 
. foreach var in `Moments'{c -(}
{txt}  2{com}.       egen `var'pl=pctile(`var'),p(5)
{txt}  3{com}.           egen `var'pu=pctile(`var'),p(95)
{txt}  4{com}.           replace `var' = . if `var' <`var'pl | (`var' >`var'pu & `var'!=.)
{txt}  5{com}. {c )-}
{txt}(6968 real changes made, 6968 to missing)
(5086 real changes made, 5086 to missing)
(10497 real changes made, 10497 to missing)
(8245 real changes made, 8245 to missing)

{com}. 
. 
. foreach var in Q24{c -(}
{txt}  2{com}. foreach mom in mean var{c -(}
{txt}  3{com}.     * nominal 
.      egen `var'_`mom'p75 =pctile(`var'_`mom'),p(75) by(year month)
{txt}  4{com}.          egen `var'_`mom'p25 =pctile(`var'_`mom'),p(25) by(year month)
{txt}  5{com}.          egen `var'_`mom'p50 =pctile(`var'_`mom'),p(50) by(year month)
{txt}  6{com}.          local lb: variable label `var'_`mom'
{txt}  7{com}.          label var `var'_`mom'p75 "`lb': 75 pctile"
{txt}  8{com}.          label var `var'_`mom'p25 "`lb': 25 pctile"
{txt}  9{com}.          label var `var'_`mom'p50 "`lb': 50 pctile"
{txt} 10{com}. {c )-}
{txt} 11{com}. {c )-}
{txt}(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)

{com}. 
. 
. *************************
. *** Nominal to real *****
. *************************
. gen Q24_rmean = Q24_mean - Q9_mean 
{txt}(49644 missing values generated)

{com}. label var Q24_rmean "mean of real earning growth of same job/time/place from y to y+1(%) "
{txt}
{com}. 
. gen Q24_rvar = Q24_var + Q9_var 
{txt}(46366 missing values generated)

{com}. label var Q24_rvar "variance of real earning growth of same job/time/place from y to y+1(%) "
{txt}
{com}. 
. ****************************************
. *** Persontage point to log change *****
. * for example: 10% is 0.1 in log change 
. ****************************************
. 
. foreach pc_var in Q24_mean Q24_rmean Q9_mean Q24_iqr{c -(}
{txt}  2{com}. replace `pc_var' = `pc_var'/100
{txt}  3{com}. {c )-}
{txt}(63765 real changes made)
(54851 real changes made)
(95693 real changes made)
(72347 real changes made)

{com}. 
. foreach pc_var in Q24_var Q24_rvar Q9_var{c -(}
{txt}  2{com}. replace `pc_var' = `pc_var'/10000
{txt}  3{com}. {c )-}
{txt}(67261 real changes made)
(63007 real changes made)
(98709 real changes made)

{com}. 
. 
. *************************
. *** Other Measures *****
. *************************
. 
. 
. egen Q24_sd = sd(Q24_mean), by(date)
{txt}(1 missing value generated)

{com}. gen Q24_disg = Q24_sd^2
{txt}(1 missing value generated)

{com}. label var Q24_disg "Disagreements of 1-yr-ahead expted income growth"
{txt}
{com}. 
. 
. egen Q24_rsd = sd(Q24_rmean), by(date)
{txt}(1 missing value generated)

{com}. gen Q24_rdisg = Q24_rsd^2
{txt}(1 missing value generated)

{com}. label var Q24_rdisg "Disagreements of 1-yr-ahead real expted income growth"
{txt}
{com}. 
. 
. ** calculate financial/numeric literacy score
. 
. gen QNUM1_ = 0 if QNUM1!=.
{txt}(93939 missing values generated)

{com}. gen QNUM2_ = 0 if QNUM2!=.
{txt}(93961 missing values generated)

{com}. gen QNUM3_ = 0 if QNUM3!=.
{txt}(94010 missing values generated)

{com}. gen QNUM5_ = 0 if QNUM5!=.
{txt}(93991 missing values generated)

{com}. gen QNUM6_ = 0 if QNUM6!=.
{txt}(94064 missing values generated)

{com}. gen QNUM8_ = 0 if QNUM8!=.
{txt}(99250 missing values generated)

{com}. gen QNUM9_ = 0 if QNUM9!=.
{txt}(99284 missing values generated)

{com}. 
. replace QNUM1_ = 1 if QNUM1==150
{txt}(14050 real changes made)

{com}. replace QNUM2_ = 1 if QNUM2<=244 & QNUM2>=240
{txt}(11058 real changes made)

{com}. replace QNUM3_ = 1 if QNUM3==10
{txt}(12426 real changes made)

{com}. replace QNUM5_ = 1 if QNUM5==100
{txt}(13564 real changes made)

{com}. replace QNUM6_ = 1 if QNUM6==5
{txt}(11794 real changes made)

{com}. replace QNUM8_ = 1 if QNUM8==3
{txt}(8449 real changes made)

{com}. replace QNUM9_ = 1 if QNUM9==2
{txt}(9218 real changes made)

{com}. 
. gen nlit = QNUM1_+QNUM2_+QNUM3_+QNUM5_+QNUM6_+QNUM8_+QNUM9_
{txt}(99358 missing values generated)

{com}. label var nlit "numeracy literacy score: (0-7)"
{txt}
{com}. 
. ***************************************************
. **** Fill the age/education for the same household
. *************************************************
. 
. 
. sort userid date 
{txt}
{com}. 
. replace nlit = nlit[_n-1] if nlit==. & userid == userid[_n-1] 
{txt}(62387 real changes made)

{com}. replace Q32 = Q32[_n-1] if Q32==. & userid == userid[_n-1] 
{txt}(93825 real changes made)

{com}. replace Q36 = Q36[_n-1] if Q36==. & userid == userid[_n-1]
{txt}(93864 real changes made)

{com}. replace Q33 = Q33[_n-1] if Q33==. & userid == userid[_n-1] & D1==1
{txt}(78652 real changes made)

{com}. replace Q47 = Q47[_n-1] if Q47==. & userid ==userid[_n-1] & D1 ==1 
{txt}(77810 real changes made)

{com}. 
. ***************************************************
. **** Winsorization
. *************************************************
. 
. drop if Q32 > 70 | Q32 < 20 /*age greater than 100 */ 
{txt}(10776 observations deleted)

{com}. 
. ***************************************************
. **** create cohort 
. *************************************************
. 
. gen byear = year - Q32
{txt}
{com}. label var byear "year of birth"
{txt}
{com}. 
. egen byear_gr = cut(byear), group(5)
{txt}
{com}. label var byear_gr "cohort by year of birth"
{txt}
{com}. 
. label define byear_grlb 0 "1952" 1 "1961" 2 "1970" 3 "1980" 4 "1998"
{txt}
{com}. label value byear_gr byear_grlb
{txt}
{com}. 
. 
. ***********************
. ** generate variables 
. ************************
. 
. ** replace educ with highest degree for each individual
. egen educ = max(Q36), by(userid) 
{txt}(4 missing values generated)

{com}. *although actually no change ine ducation within the panel 
. 
. ** education group 
. gen educ_gr = .
{txt}(98597 missing values generated)

{com}. replace educ_gr = 1 if educ==1
{txt}(855 real changes made)

{com}. replace educ_gr = 2 if educ==2 | educ ==3 | educ == 4
{txt}(42895 real changes made)

{com}. replace educ_gr = 3 if educ <=9 & educ>4
{txt}(54843 real changes made)

{com}. drop if educ_gr==.
{txt}(4 observations deleted)

{com}. 
. label var educ_gr "education group"
{txt}
{com}. label define educ_grlb 1 "HS dropout" 2 "HS graduate" 3 "College/above"
{txt}
{com}. label value educ_gr educ_grlb
{txt}
{com}. 
. save "${c -(}folder{c )-}/SCE/IncExpSCEProbIndM",replace 
{txt}file /Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData//SCE/IncExpSCEProbIndM.dta saved

{com}. 
. ***************************************
. **   Histograms of Moments  ***********
. ** Maybe replaced by kernel desntiy **
. ***************************************
. 
. * for forecasting
. 
. gen SCE_mean = .
{txt}(98593 missing values generated)

{com}. gen SCE_var = .
{txt}(98593 missing values generated)

{com}. 
. /*
> * Kernal density plot only 
> 
> label var Q24_mean "1-yr-ahead forecast of income growth "
> 
>  foreach var in SCE{c -(}
>  foreach mom in mean{c -(}
>     replace `var'_`mom' = Q24_`mom'
>         local lb: variable label Q24_`mom'
>     twoway (kdensity `var'_`mom',lcolor(red) lwidth(thick) ), ///
>                by(year,title("Distribution of `lb'",size(med)) note("")) xtitle("Mean forecast") ///
>                    ytitle("Fraction of population")
>         graph export "${c -(}sum_graph_folder{c )-}/hist/`var'`mom'_hist", as(png) replace 
> {c )-}
> {c )-}
> 
> * Kernal density plot only 
> 
> 
> label var Q24_var "1-yr-ahead uncertainty of income growth"
> 
> foreach mom in var{c -(}
> foreach var in SCE{c -(}
>     replace `var'_`mom' = Q24_`mom'
>         local lb: variable label Q24_`mom'
>     twoway (kdensity `var'_`mom',lcolor(blue) lwidth(thick)), ///
>                by(year,title("Distribution of `lb'",size(med)) note("")) xtitle("Uncertainty") ///
>                    ytitle("Fraction of population")
>         graph export "${c -(}sum_graph_folder{c )-}/hist/`var'`mom'_hist", as(png) replace 
> {c )-}
> {c )-}
> 
> */
. 
. *************************
. *** Population SCE ******
. *************************
. 
. local Moments Q24_mean Q24_var Q24_iqr Q24_cent50 Q24_disg 
{txt}
{com}. local rMoments Q24_rmean Q24_rvar Q24_rdisg 
{txt}
{com}. local MomentsMom Q24_meanp25 Q24_meanp50 Q24_meanp75 Q24_varp25 Q24_varp50 Q24_varp75
{txt}
{com}. 
. 
. collapse (mean) `Moments' `rMoments' `MomentsMom', by(date year month)
{txt}
{com}. 
. label var Q24_mean "Average 1-yr-ahead expected earning growth(%)"
{txt}
{com}. label var Q24_var "Average Uncertainty of 1-yr-ahead expected earning growth"
{txt}
{com}. label var Q24_iqr "Average 25/75 IQR of 1-yr-ahead expected earning growth(%)"
{txt}
{com}. label var Q24_cent50 "Average Median of 1-yr-ahead expected earning growth(%)"
{txt}
{com}. label var Q24_disg "Disagreements of 1-yr-ahead expected earning growth"
{txt}
{com}. 
. 
. label var Q24_rmean "Average 1-yr-ahead expected real earning growth(%)"
{txt}
{com}. label var Q24_rvar "Average Uncertainty of 1-yr-ahead real expected earning growth"
{txt}
{com}. label var Q24_rdisg "Disagreements of 1-yr-ahead expected real earning growth"
{txt}
{com}. 
. save "${c -(}folder{c )-}/SCE/IncExpSCEProbPopM",replace 
{txt}file /Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData//SCE/IncExpSCEProbPopM.dta saved

{com}. 
. 
. 
. 
{txt}end of do-file

{com}. clear

. do "/var/folders/k3/fzq0vzzx2b56ypvhsddgs7hr0000gn/T//SD01766.000000"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> */
. 
. ***************************************************
. **** subselect variables from core module of SCE ***
. ****************************************************
. 
. use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
{txt}
{com}. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "/Users/Myworld/Dropbox/SearchMatchExpectation/code/SCE.do"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> */
. 
. ***************************************************
. **** subselect variables from core module of SCE ***
. ****************************************************
. 
. use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
{txt}
{com}. 
. global keep_list year month userid weight ///
>        Q32 Q33 Q37 state D6 D2new_9 DSAME Q12new Q13new Q14new ///
>            Q10_1 Q10_2 Q10_3 Q10_4 Q10_5 Q10_6 Q10_7 Q10_8 Q10_9 Q10_10 Q11 ///
>            Q17new Q18new Q19 Q20new Q21new Q22new
{txt}
{com}. 
. keep ${c -(}keep_list{c )-}
{txt}
{com}. 
. save "${c -(}folder{c )-}/IncExpSCEIndM_short",replace 
{txt}(note: file /Users/Myworld/Dropbox/SearchMatchExpectation//data/SCE/IncExpSCEIndM_short.dta not found)
file /Users/Myworld/Dropbox/SearchMatchExpectation//data/SCE/IncExpSCEIndM_short.dta saved

{com}. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "/var/folders/k3/fzq0vzzx2b56ypvhsddgs7hr0000gn/T//SD01766.000000"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> */
. 
. ***************************************************
. **** subselect variables from core module of SCE ***
. ****************************************************
. 
. use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
{txt}
{com}. 
. global keep_list year month userid weight ///
>        Q32 Q33 Q37 state D6 D2new_9 DSAME Q12new Q13new Q14new ///
>            Q10_1 Q10_2 Q10_3 Q10_4 Q10_5 Q10_6 Q10_7 Q10_8 Q10_9 Q10_10 Q11 ///
>            Q17new Q18new Q19 Q20new Q21new Q22new
{txt}
{com}. 
. keep ${c -(}keep_list{c )-}
{txt}
{com}. 
. save "${c -(}folder{c )-}/IncExpSCEIndM_short",replace 
{txt}file /Users/Myworld/Dropbox/SearchMatchExpectation//data/SCE/IncExpSCEIndM_short.dta saved

{com}. 
. 
. ***************************************************
. ***** merge SCE core and labor market module ****
. ************************************************
. 
. use "${c -(}folder{c )-}/IncExpSCEIndM_short",clear
{txt}
{com}. 
. merge 1:1 year month userid using "${c -(}folder{c )-}/LaborExpSCEIndM", keep(master match using)
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}          83,800
{txt}{col 9}from master{col 30}{res}          81,988{txt}  (_merge==1)
{col 9}from using{col 30}{res}           1,812{txt}  (_merge==2)

{col 5}matched{col 30}{res}          16,605{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge sce_module_merge
{res}{txt}
{com}. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "/var/folders/k3/fzq0vzzx2b56ypvhsddgs7hr0000gn/T//SD01766.000000"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> 
> 
> ***************************************************
> **** subselect variables from core module of SCE ***
> ****************************************************
> 
> use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
> 
> global keep_list year month userid weight ///
>        Q32 Q33 Q37 state D6 D2new_9 DSAME Q12new Q13new Q14new ///
>            Q10_1 Q10_2 Q10_3 Q10_4 Q10_5 Q10_6 Q10_7 Q10_8 Q10_9 Q10_10 Q11 ///
>            Q17new Q18new Q19 Q20new Q21new Q22new
> 
> keep ${c -(}keep_list{c )-}
> 
> save "${c -(}folder{c )-}/IncExpSCEIndM_short",replace 
> */
. 
. ***************************************************
. ***** merge SCE core and labor market module ****
. ************************************************
. 
. use "${c -(}folder{c )-}/IncExpSCEIndM_short",clear
{txt}
{com}. 
. merge 1:1 year month userid using "${c -(}folder{c )-}/LaborExpSCEIndM", keep(master match using)
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}          83,800
{txt}{col 9}from master{col 30}{res}          81,988{txt}  (_merge==1)
{col 9}from using{col 30}{res}           1,812{txt}  (_merge==2)

{col 5}matched{col 30}{res}          16,605{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge sce_module_merge
{res}{txt}
{com}. 
. *****************************************************
. *** generate aggregate average rates expectations ***
. ****************************************************
. 
. keep if l1y!=.  
{txt}(88116 observations deleted)

{com}. * keep only obs with current job 
. 
. gen exp_en = oo1_6  
{txt}(7535 missing values generated)

{com}. gen exp_eu = oo1_5
{txt}(6929 missing values generated)

{com}. gen exp_es = oo1_4 
{txt}(6563 missing values generated)

{com}. gen exp_ee_change = oo1_3 
{txt}(5397 missing values generated)

{com}. gen exp_ee_stay = oo1_2 
{txt}(1627 missing values generated)

{com}. gen exp_ee = exp_ee_change+exp_ee_stay
{txt}(5537 missing values generated)

{com}. gen exp_ue = Q22new 
{txt}(1808 missing values generated)

{com}. 
. label var exp_en "expected prob from e to non-participation from m to m+4"
{txt}
{com}. label var exp_eu "expected prob from e to ue from m to m+4"
{txt}
{com}. label var exp_es "expected prob from e to self-employment from m to m+4"
{txt}
{com}. label var exp_ee_change "expected prob from e to e at a different job from m to m+4"
{txt}
{com}. label var exp_ee_stay "expected prob from e to e at the same job from m to m+4"
{txt}
{com}. label var exp_ee "expected prob from e to e from m to m+4"
{txt}
{com}. label var exp_ue "expected prob of finding a job if ue from m to m+3"
{txt}
{com}. 
. dddd
{err}unrecognized command:  dddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. hist Q19
{res}
{com}. summarize Q19

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 9}Q19 {c |}{res}         0

{com}. summarize Q18new

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}Q18new {c |}{res}         0

{com}. summarize Q22

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}Q22new {c |}{res}     10481    55.85068    31.83255          0        100

{com}. do "/var/folders/k3/fzq0vzzx2b56ypvhsddgs7hr0000gn/T//SD01766.000000"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> 
> 
> ***************************************************
> **** subselect variables from core module of SCE ***
> ****************************************************
> 
> use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
> 
> global keep_list year month userid weight ///
>        Q32 Q33 Q37 state D6 D2new_9 DSAME Q12new Q13new Q14new ///
>            Q10_1 Q10_2 Q10_3 Q10_4 Q10_5 Q10_6 Q10_7 Q10_8 Q10_9 Q10_10 Q11 ///
>            Q17new Q18new Q19 Q20new Q21new Q22new
> 
> keep ${c -(}keep_list{c )-}
> 
> save "${c -(}folder{c )-}/IncExpSCEIndM_short",replace 
> */
. 
. ***************************************************
. ***** merge SCE core and labor market module ****
. ************************************************
. 
. use "${c -(}folder{c )-}/IncExpSCEIndM_short",clear
{txt}
{com}. 
. merge 1:1 year month userid using "${c -(}folder{c )-}/LaborExpSCEIndM", keep(master match using)
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}          83,800
{txt}{col 9}from master{col 30}{res}          81,988{txt}  (_merge==1)
{col 9}from using{col 30}{res}           1,812{txt}  (_merge==2)

{col 5}matched{col 30}{res}          16,605{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge sce_module_merge
{res}{txt}
{com}. 
. *****************************************************
. *** generate aggregate average rates expectations ***
. ****************************************************
. 
. keep if l1y!=.  
{txt}(88116 observations deleted)

{com}. * keep only obs with current job 
. 
. gen exp_en = oo1_6  
{txt}(7535 missing values generated)

{com}. gen exp_eu = oo1_5
{txt}(6929 missing values generated)

{com}. gen exp_es = oo1_4 
{txt}(6563 missing values generated)

{com}. gen exp_ee_change = oo1_3 
{txt}(5397 missing values generated)

{com}. gen exp_ee_stay = oo1_2 
{txt}(1627 missing values generated)

{com}. gen exp_ee = exp_ee_change+exp_ee_stay
{txt}(5537 missing values generated)

{com}. gen exp_ue = Q22new
{txt}(1808 missing values generated)

{com}. gen exp_ieu_1y = Q13new
{txt}(1816 missing values generated)

{com}. gen exp_veu_1y = Q14new
{txt}(1813 missing values generated)

{com}. 
. label var exp_en "expected prob from e to non-participation from m to m+4"
{txt}
{com}. label var exp_eu "expected prob from e to ue from m to m+4"
{txt}
{com}. label var exp_es "expected prob from e to self-employment from m to m+4"
{txt}
{com}. label var exp_ee_change "expected prob from e to e at a different job from m to m+4"
{txt}
{com}. label var exp_ee_stay "expected prob from e to e at the same job from m to m+4"
{txt}
{com}. label var exp_ee "expected prob from e to e from m to m+4"
{txt}
{com}. label var exp_ue "expected prob of finding a job if ue from m to m+3"
{txt}
{com}. label var exp_ieu_1y "expected prob of losing the job from y to y+1"
{txt}
{com}. label var exp_veu_1y "expected prob of voluntarily leaving the job from y to y+1"
{txt}
{com}. 
. *****************
. ** summary stats
. *****************
. 
. global exp_rates exp_en exp_eu exp_es exp_ee_change exp_ee_stay exp_ee exp_ue exp_ieu_1y exp_veu_1y
{txt}
{com}. 
. summarize ${c -(}exp_rates{c )-}

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}exp_en {c |}{res}      4754    3.406815    12.85871          0        100
{txt}{space 6}exp_eu {c |}{res}      5360    4.431716    9.208994          0        100
{txt}{space 6}exp_es {c |}{res}      5726    21.65526    37.48647          0        100
{txt}exp_ee_cha~e {c |}{res}      6892    15.02539    19.90427          0        100
{txt}{space 1}exp_ee_stay {c |}{res}     10662    82.78691    26.64279          0        100
{txt}{hline 13}{c +}{hline 56}
{space 6}exp_ee {c |}{res}      6752    89.06887    23.59591          0        110
{txt}{space 6}exp_ue {c |}{res}     10481    55.85068    31.83255          0        100
{txt}{space 2}exp_ieu_1y {c |}{res}     10473    14.08431    19.27732          0        100
{txt}{space 2}exp_veu_1y {c |}{res}     10476    22.03961    26.92852          0        100
{txt}
{com}. 
. *****************
. ** histograms of indidividuals 
. ******************
. 
. 
. foreach prob in ${c -(}exp_rates{c )-}{c -(}
{err}program error:  code follows on the same line as open brace
{txt}{search r(198):r(198);}

end of do-file

{search r(198):r(198);}

{com}. do "/Users/Myworld/Dropbox/SearchMatchExpectation/code/SCE.do"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> 
> 
> ***************************************************
> **** subselect variables from core module of SCE ***
> ****************************************************
> 
> use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
> 
> global keep_list year month userid weight ///
>        Q32 Q33 Q37 state D6 D2new_9 DSAME Q12new Q13new Q14new ///
>            Q10_1 Q10_2 Q10_3 Q10_4 Q10_5 Q10_6 Q10_7 Q10_8 Q10_9 Q10_10 Q11 ///
>            Q17new Q18new Q19 Q20new Q21new Q22new
> 
> keep ${c -(}keep_list{c )-}
> 
> save "${c -(}folder{c )-}/IncExpSCEIndM_short",replace 
> */
. 
. ***************************************************
. ***** merge SCE core and labor market module ****
. ************************************************
. 
. use "${c -(}folder{c )-}/IncExpSCEIndM_short",clear
{txt}
{com}. 
. merge 1:1 year month userid using "${c -(}folder{c )-}/LaborExpSCEIndM", keep(master match using)
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}          83,800
{txt}{col 9}from master{col 30}{res}          81,988{txt}  (_merge==1)
{col 9}from using{col 30}{res}           1,812{txt}  (_merge==2)

{col 5}matched{col 30}{res}          16,605{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge sce_module_merge
{res}{txt}
{com}. 
. *****************************************************
. *** generate aggregate average rates expectations ***
. ****************************************************
. 
. keep if l1y!=.  
{txt}(88116 observations deleted)

{com}. * keep only obs with current job 
. 
. gen exp_en = oo1_6  
{txt}(7535 missing values generated)

{com}. gen exp_eu = oo1_5
{txt}(6929 missing values generated)

{com}. gen exp_es = oo1_4 
{txt}(6563 missing values generated)

{com}. gen exp_ee_change = oo1_3 
{txt}(5397 missing values generated)

{com}. gen exp_ee_stay = oo1_2 
{txt}(1627 missing values generated)

{com}. gen exp_ee = exp_ee_change+exp_ee_stay
{txt}(5537 missing values generated)

{com}. gen exp_ue = Q22new
{txt}(1808 missing values generated)

{com}. gen exp_ieu_1y = Q13new
{txt}(1816 missing values generated)

{com}. gen exp_veu_1y = Q14new
{txt}(1813 missing values generated)

{com}. 
. label var exp_en "expected prob from e to non-participation from m to m+4"
{txt}
{com}. label var exp_eu "expected prob from e to ue from m to m+4"
{txt}
{com}. label var exp_es "expected prob from e to self-employment from m to m+4"
{txt}
{com}. label var exp_ee_change "expected prob from e to e at a different job from m to m+4"
{txt}
{com}. label var exp_ee_stay "expected prob from e to e at the same job from m to m+4"
{txt}
{com}. label var exp_ee "expected prob from e to e from m to m+4"
{txt}
{com}. label var exp_ue "expected prob of finding a job if ue from m to m+3"
{txt}
{com}. label var exp_ieu_1y "expected prob of losing the job from y to y+1"
{txt}
{com}. label var exp_veu_1y "expected prob of voluntarily leaving the job from y to y+1"
{txt}
{com}. 
. *****************
. ** summary stats
. *****************
. 
. local exp_rates exp_en exp_eu exp_es exp_ee_change exp_ee_stay exp_ee exp_ue exp_ieu_1y exp_veu_1y
{txt}
{com}. 
. summarize `exp_rates'

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}exp_en {c |}{res}      4754    3.406815    12.85871          0        100
{txt}{space 6}exp_eu {c |}{res}      5360    4.431716    9.208994          0        100
{txt}{space 6}exp_es {c |}{res}      5726    21.65526    37.48647          0        100
{txt}exp_ee_cha~e {c |}{res}      6892    15.02539    19.90427          0        100
{txt}{space 1}exp_ee_stay {c |}{res}     10662    82.78691    26.64279          0        100
{txt}{hline 13}{c +}{hline 56}
{space 6}exp_ee {c |}{res}      6752    89.06887    23.59591          0        110
{txt}{space 6}exp_ue {c |}{res}     10481    55.85068    31.83255          0        100
{txt}{space 2}exp_ieu_1y {c |}{res}     10473    14.08431    19.27732          0        100
{txt}{space 2}exp_veu_1y {c |}{res}     10476    22.03961    26.92852          0        100
{txt}
{com}. 
. *****************
. ** histograms of indidividuals 
. ******************
. 
. 
. foreach prob in `exp_rates'{c -(}
{txt}  2{com}. hist `prob'
{txt}  3{com}. graph export "${c -(}graph_folder{c )-}/sce_individual_dist/hist_`prob'",as(png) replace
{txt}  4{com}. {c )-}
{txt}(bin={res}36{txt}, start={res}0{txt}, width={res}2.7777778{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_en written in PNG format)
(bin={res}37{txt}, start={res}0{txt}, width={res}2.7027027{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_eu written in PNG format)
(bin={res}37{txt}, start={res}0{txt}, width={res}2.7027027{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_es written in PNG format)
(bin={res}38{txt}, start={res}0{txt}, width={res}2.6315789{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_ee_change written in PNG format)
(bin={res}40{txt}, start={res}0{txt}, width={res}2.5{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_ee_stay written in PNG format)
(bin={res}38{txt}, start={res}0{txt}, width={res}2.8947368{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_ee written in PNG format)
(bin={res}40{txt}, start={res}0{txt}, width={res}2.5{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_ue written in PNG format)
(bin={res}40{txt}, start={res}0{txt}, width={res}2.5{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_ieu_1y written in PNG format)
(bin={res}40{txt}, start={res}0{txt}, width={res}2.5{txt})
{res}{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//sce_individual_dist/hist_exp_veu_1y written in PNG format)

{com}. */
. 
. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "/Users/Myworld/Dropbox/SearchMatchExpectation/code/SCE.do"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> 
> 
> ***************************************************
> **** subselect variables from core module of SCE ***
> ****************************************************
> 
> use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
> 
> global keep_list year month userid weight ///
>        Q32 Q33 Q37 state D6 D2new_9 DSAME Q12new Q13new Q14new ///
>            Q10_1 Q10_2 Q10_3 Q10_4 Q10_5 Q10_6 Q10_7 Q10_8 Q10_9 Q10_10 Q11 ///
>            Q17new Q18new Q19 Q20new Q21new Q22new
> 
> keep ${c -(}keep_list{c )-}
> 
> save "${c -(}folder{c )-}/IncExpSCEIndM_short",replace 
> */
. 
. ***************************************************
. ***** merge SCE core and labor market module ****
. ************************************************
. 
. use "${c -(}folder{c )-}/IncExpSCEIndM_short",clear
{txt}
{com}. 
. merge 1:1 year month userid using "${c -(}folder{c )-}/LaborExpSCEIndM", keep(master match using)
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}          83,800
{txt}{col 9}from master{col 30}{res}          81,988{txt}  (_merge==1)
{col 9}from using{col 30}{res}           1,812{txt}  (_merge==2)

{col 5}matched{col 30}{res}          16,605{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge sce_module_merge
{res}{txt}
{com}. 
. *****************************************************
. *** generate aggregate average rates expectations ***
. ****************************************************
. 
. keep if l1y!=.  
{txt}(88116 observations deleted)

{com}. * keep only obs with current job 
. 
. gen exp_en = oo1_6  
{txt}(7535 missing values generated)

{com}. gen exp_eu = oo1_5
{txt}(6929 missing values generated)

{com}. gen exp_es = oo1_4 
{txt}(6563 missing values generated)

{com}. gen exp_ee_change = oo1_3 
{txt}(5397 missing values generated)

{com}. gen exp_ee_stay = oo1_2 
{txt}(1627 missing values generated)

{com}. gen exp_ee = exp_ee_change+exp_ee_stay
{txt}(5537 missing values generated)

{com}. gen exp_ue = Q22new
{txt}(1808 missing values generated)

{com}. gen exp_ieu_1y = Q13new
{txt}(1816 missing values generated)

{com}. gen exp_veu_1y = Q14new
{txt}(1813 missing values generated)

{com}. 
. *****************
. ** summary stats
. *****************
. 
. local exp_rates exp_en exp_eu exp_es exp_ee_change exp_ee_stay exp_ee exp_ue exp_ieu_1y exp_veu_1y
{txt}
{com}. 
. summarize `exp_rates'

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}exp_en {c |}{res}      4754    3.406815    12.85871          0        100
{txt}{space 6}exp_eu {c |}{res}      5360    4.431716    9.208994          0        100
{txt}{space 6}exp_es {c |}{res}      5726    21.65526    37.48647          0        100
{txt}exp_ee_cha~e {c |}{res}      6892    15.02539    19.90427          0        100
{txt}{space 1}exp_ee_stay {c |}{res}     10662    82.78691    26.64279          0        100
{txt}{hline 13}{c +}{hline 56}
{space 6}exp_ee {c |}{res}      6752    89.06887    23.59591          0        110
{txt}{space 6}exp_ue {c |}{res}     10481    55.85068    31.83255          0        100
{txt}{space 2}exp_ieu_1y {c |}{res}     10473    14.08431    19.27732          0        100
{txt}{space 2}exp_veu_1y {c |}{res}     10476    22.03961    26.92852          0        100
{txt}
{com}. 
. *****************
. ** histograms of indidividuals 
. ******************
. 
. /*
> foreach prob in `exp_rates'{c -(}
> hist `prob'
> graph export "${c -(}graph_folder{c )-}/sce_individual_dist/hist_`prob'",as(png) replace
> {c )-}
> */
. 
. ddd
{err}unrecognized command:  ddd
{txt}{search r(199):r(199);}

end of do-file

{search r(199):r(199);}

{com}. do "/Users/Myworld/Dropbox/SearchMatchExpectation/code/SCE.do"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. global SCE_core_folder "/Users/Myworld/Dropbox/IncExpProject/WorkingFolder/SurveyData/SCE/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. /*
> *****************************
> *** import raw labor market SCE
> *********************************
> 
> import excel "${c -(}folder{c )-}/sce-labor-microdata-public.xlsx", sheet("Data") cellrange(A2:DN18419) firstrow
> 
> ********************
> *** Date format ****
> ********************
> gen date_str = string(date)
> gen year = substr(date_str,1,4)
> gen month = substr(date_str,5,2)
> gen date2=year+"m"+month
> gen date3= monthly(date2,"YM")
> format date3 %tm
> drop date_str date2 date
> rename date3 date
> destring year, replace
> destring month, replace 
> order date year month
> xtset userid date
> 
> 
> label var l1m "starting month of current/main job"
> label var l1y "starting year of current/main job"
> label var l3 "(average) annual earning from the current/main job before tax/deductions (in $)"
> label var l4 "(average) annual earning from the current/main job before tax/deductions by range"
> label var l4b "expected annual earning from the current/main job at y+10 (nominal)"
> label var lmtype "employer type of current/main"
> label var lmtype_5_other "employer type (others)"
> label var lmind "business/industry of current employer"
> label var lm5_1 "employer benefits: pension plan"
> label var lm5_2 "employer benefits: pension plan"
> label var lm5_3  "employer benefits: health insurance"
> label var lm5_4 "employer benefits: dental/vision insurance"
> label var lm5_5  "employer benefits: health care or dependent care"
> label var lm5_6  "employer benefits: housing/husing subsidy"
> label var lm5_7  "employer benefits: life/disability insurance"
> label var lm5_8 "employer benefits: commuter benefits"
> label var lm5_9 "employer benefits: childcare assistance"
> label var lm5_10 "employer benefits: other"
> label var lm5_10_other "employer benefits: other specified"
> label var lm5_11 "employer benefits: none"
> label var lmsat1 "satisfied with compensation (1-5 more satisfied)"
> label var lmsat2 "satisfied with other aspect of the job (1-5 more satisfied)"
> label var lmsat3 "fit with the job (1-7 more fit)"
> label var lmsat4 "opportunity for promotion/progression from y to y+3"
> label var lmsat5 "overall satisfication (1-5 more satisfied)"
> label var l7m "last month of the most recent job"
> label var l7y "last year of the most recent job"
> label var l7dk_1 "never had a paid job"
> label var l7bm "starting month of the most recent job"
> label var l7by "starting year of the most recent job"
> label var l9 "(average) annual earning from the most recent job before tax/deductions (in $)"
> label var l10 "(average) annual earning from the most recent job before tax/deductions by range"
> label var l11 "work for someone(1) or self-employment (2)"
> label var l12 "employer type of most recent job"
> label var l12_5_other "employer type of most recent job (other)"
> label var l12b "business/industry of the most recent job"
> label var l13_1 "employer benefits most recent job: pension plans"
> label var l13_2 ""
> label var l13_3 ""
> label var l13_4 ""
> label var l13_5 ""
> label var l13_6 ""
> label var l13_7 ""
> label var l13_8 ""
> label var l13_9 ""
> label var l13_10 ""
> label var l13_11 ""
> label var l13_10_other ""
> label var js5 "have looked for a job m-1 to m (1 yes 2 no)"
> label var js6 "looking for a job leaving current (1), not leaving (2), no (3)" 
> label var rw2a "min wage/salary for accepting a hypothetical job offer right now"
> label var rw2b "unit for wage (hour 1 week 2 biweek 3 month 4 year 5) till 2017, yearly after 2017"
> label var js7 "nb of weeks looking for a job"
> label var js8_1 "things done to look for a job"
> label var js8_2 ""
> label var js8_3 ""
> label var js8_4 ""
> label var js8_5 ""
> label var js8_6 ""
> label var js8_7 ""
> label var js8_8 ""
> label var js8_9 ""
> label var js8_10 ""
> label var js8_11 ""
> label var js8_12 ""
> label var js8_13 ""
> label var js8_14 ""
> label var js8_14_other
> label var js9 "nb of hours spent on job search from d-7 to d"
> label var nl1 "nb of job offers received from m-4 to m"
> label var nl2a_1 ""
> label var nl2a_2 ""
> label var nl2a_3 ""
> label var nl2b_1 ""
> label var nl2b_2 ""
> label var nl2b_3 ""
> label var nl3_1 "currently working at the accepted job"
> label var nl3_2 "once worked at the accepted job"
> label var nl3_3 "rejected the job offer"
> label var nl4_1 ""
> label var nl4_2 ""
> label var nl4_3 "" 
> label var oo1_1 "expected prob of employed from m to m+4" 
> label var oo1_2 "expected prob of employed by same employer from m to m+4" 
> label var oo1_3 "expected prob of employed by a different employer from m to m+4" 
> label var oo1_4 "expected prob of self-employed from m to m+4" 
> label var oo1_5 "expected prob of unemployed/looking for a job from m to m+4" 
> label var oo1_6 "expected prob of unemployed/not looking for a job from m to m+4" 
> label var oo2u "expected prob of receing >1 job offer from m to m+4" 
> label var oo2e "expected prob of receing >1 job offer from another employer m to m+4" 
> label var oo2new "expected nb of job offers received from m to m+4" 
> label var oo2a "expected AVERAGE wage ($ annual) for possible offers received from m to m+4" 
> label var oo2a2 "expected MAX wage ($ annual) for possible offers received from m to m+4" 
> label var oo2b_1 ""
> label var oo2b_2 ""
> label var oo2b_3 ""
> label var oo2b_4 ""
> label var oo2b_5 ""
> label var oo2b_6 ""
> label var oo2c1 "prob of accepting an offer at wage < 0.8 average expected wage offer"
> label var oo2c2 "prob of accepting an offer at wage between 0.8-0.9 average expected wage offer"
> label var oo2c3 "prob of accepting an offer at wage between 0.9-1.0 average expected wage offer"
> label var oo2c4 "prob of accepting an offer at wage between 1.0-1.1 average expected wage offer"
> label var oo2c5 "prob of accepting an offer at wage between 1.1-1.2 average expected wage offer"
> label var oo2c6 "prob of accepting an offer at wage>1.2*average expected wage offer"
> label var oo2e2 "expected earning in m+4 (in $)"
> label var oo2e2dk_1 "zero earning due to non-working from m to m+4"
> label var oo2f ""
> label var q113 ""
> label var q115 ""
> label var q117 "planed retirement age"
> label var q118 "planed retirement age has changed from y-1 to y(1 sooner 2 no change 3 later)"
> label var q119 "nb of years earlier before retirement than planed"
> label var q120  "nb of years later before retirement than planed"
> label var q121  ""
> label var q122 ""
> 
> save "${c -(}folder{c )-}/LaborExpSCEIndM",replace 
> 
> 
> ***************************************************
> **** subselect variables from core module of SCE ***
> ****************************************************
> 
> use "${c -(}SCE_core_folder{c )-}/IncExpSCEProbIndM.dta", clear
> 
> global keep_list year month userid weight ///
>        Q32 Q33 Q37 state D6 D2new_9 DSAME Q12new Q13new Q14new ///
>            Q10_1 Q10_2 Q10_3 Q10_4 Q10_5 Q10_6 Q10_7 Q10_8 Q10_9 Q10_10 Q11 ///
>            Q17new Q18new Q19 Q20new Q21new Q22new
> 
> keep ${c -(}keep_list{c )-}
> 
> save "${c -(}folder{c )-}/IncExpSCEIndM_short",replace 
> */
. 
. ***************************************************
. ***** merge SCE core and labor market module ****
. ************************************************
. 
. use "${c -(}folder{c )-}/IncExpSCEIndM_short",clear
{txt}
{com}. 
. merge 1:1 year month userid using "${c -(}folder{c )-}/LaborExpSCEIndM", keep(master match using)
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}          83,800
{txt}{col 9}from master{col 30}{res}          81,988{txt}  (_merge==1)
{col 9}from using{col 30}{res}           1,812{txt}  (_merge==2)

{col 5}matched{col 30}{res}          16,605{txt}  (_merge==3)
{col 5}{hline 41}

{com}. rename _merge sce_module_merge
{res}{txt}
{com}. 
. *****************************************************
. *** generate aggregate average rates expectations ***
. ****************************************************
. 
. keep if l1y!=.  
{txt}(88116 observations deleted)

{com}. * keep only obs with current job 
. 
. gen exp_en = oo1_6  
{txt}(7535 missing values generated)

{com}. gen exp_eu = oo1_5
{txt}(6929 missing values generated)

{com}. gen exp_es = oo1_4 
{txt}(6563 missing values generated)

{com}. gen exp_ee_change = oo1_3 
{txt}(5397 missing values generated)

{com}. gen exp_ee_stay = oo1_2 
{txt}(1627 missing values generated)

{com}. gen exp_ee = exp_ee_change+exp_ee_stay
{txt}(5537 missing values generated)

{com}. gen exp_ue = Q22new
{txt}(1808 missing values generated)

{com}. gen exp_ieu_1y = Q13new
{txt}(1816 missing values generated)

{com}. gen exp_veu_1y = Q14new
{txt}(1813 missing values generated)

{com}. 
. *****************
. ** summary stats
. *****************
. 
. local exp_rates exp_en exp_eu exp_es exp_ee_change exp_ee_stay exp_ee exp_ue exp_ieu_1y exp_veu_1y
{txt}
{com}. 
. summarize `exp_rates'

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}exp_en {c |}{res}      4754    3.406815    12.85871          0        100
{txt}{space 6}exp_eu {c |}{res}      5360    4.431716    9.208994          0        100
{txt}{space 6}exp_es {c |}{res}      5726    21.65526    37.48647          0        100
{txt}exp_ee_cha~e {c |}{res}      6892    15.02539    19.90427          0        100
{txt}{space 1}exp_ee_stay {c |}{res}     10662    82.78691    26.64279          0        100
{txt}{hline 13}{c +}{hline 56}
{space 6}exp_ee {c |}{res}      6752    89.06887    23.59591          0        110
{txt}{space 6}exp_ue {c |}{res}     10481    55.85068    31.83255          0        100
{txt}{space 2}exp_ieu_1y {c |}{res}     10473    14.08431    19.27732          0        100
{txt}{space 2}exp_veu_1y {c |}{res}     10476    22.03961    26.92852          0        100
{txt}
{com}. 
. *****************
. ** histograms of indidividuals 
. ******************
. 
. /*
> foreach prob in `exp_rates'{c -(}
> hist `prob'
> graph export "${c -(}graph_folder{c )-}/sce_individual_dist/hist_`prob'",as(png) replace
> {c )-}
> */
. 
. 
. 
. *********************
. ** aggregate average 
. ********************
. 
. collapse `exp_rates', by(date year month)
{txt}
{com}. 
. *********************
. ** convert to 0-1 scale 
. ********************
. 
. foreach rate in `exp_rates'{c -(}
{txt}  2{com}. replace `rate'=`rate'/100
{txt}  3{com}. {c )-}
{txt}(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
(15 real changes made)
(16 real changes made)
(16 real changes made)
(16 real changes made)

{com}. 
. 
. label var exp_en "expected prob from e to non-participation from m to m+4"
{txt}
{com}. label var exp_eu "expected prob from e to ue from m to m+4"
{txt}
{com}. label var exp_es "expected prob from e to self-employment from m to m+4"
{txt}
{com}. label var exp_ee_change "expected prob from e to e at a different job from m to m+4"
{txt}
{com}. label var exp_ee_stay "expected prob from e to e at the same job from m to m+4"
{txt}
{com}. label var exp_ee "expected prob from e to e from m to m+4"
{txt}
{com}. label var exp_ue "expected prob of finding a job if ue from m to m+3"
{txt}
{com}. label var exp_ieu_1y "expected prob of losing the job from y to y+1"
{txt}
{com}. label var exp_veu_1y "expected prob of voluntarily leaving the job from y to y+1"
{txt}
{com}. 
. *************************
. * from month to quarter 
. *************************
. 
. rename month month_survey
{res}{txt}
{com}. 
. gen month = .
{txt}(16 missing values generated)

{com}. replace month = 4 if month_survey ==3
{txt}(6 real changes made)

{com}. replace month = 7 if month_survey ==7 
{txt}(5 real changes made)

{com}. replace month = 10 if month_survey == 11
{txt}(5 real changes made)

{com}. drop date
{txt}
{com}. ** the month to be merged with CPS
. save "${c -(}folder{c )-}/LaborExpSCEPopM.dta",replace 
{txt}file /Users/Myworld/Dropbox/SearchMatchExpectation//data/SCE/LaborExpSCEPopM.dta saved

{com}. 
. 
. 
{txt}end of do-file

{com}. clear

. clear

. do "/Users/Myworld/Dropbox/SearchMatchExpectation/code/SCE_CPS_compare.do"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. 
. /*
> ** reformat date in CPS data
> 
> use "${c -(}mainfolder{c )-}/workingdata/CPS_worker_flows.dta",clear
> generate date = dofc(tq)
> format date %td
> *gen year = year(date)
> *gen month = month(date)
> save "${c -(}mainfolder{c )-}/workingdata/CPS_worker_flows.dta",replace
> */
. 
. 
. use "${c -(}folder{c )-}/LaborExpSCEPopM.dta",clear
{txt}
{com}. merge 1:1 year month using "${c -(}mainfolder{c )-}/workingdata/CPS_worker_flows.dta",keep(master match using)
{res}{txt}{p 0 7 2}
(note: variable
year was 
int, now float to accommodate using data's values)
{p_end}

{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}              84
{txt}{col 9}from master{col 30}{res}               0{txt}  (_merge==1)
{col 9}from using{col 30}{res}              84{txt}  (_merge==2)

{col 5}matched{col 30}{res}              16{txt}  (_merge==3)
{col 5}{hline 41}

{com}. drop _merge 
{txt}
{com}. 
. *****************************
. *** generate monthly date
. *****************************
. gen date_str=string(year)+"m"+string(month)
{txt}
{com}. gen ymdate= monthly(date_str,"YM")
{txt}
{com}. format ymdate %tm
{txt}
{com}. drop date 
{txt}
{com}. rename ymdate date
{res}{txt}
{com}. tsset date
{res}{txt}{col 9}time variable:  {res}{col 25}date, 1995m1 to 2019m10, but with gaps
{txt}{col 17}delta:  {res}1 month
{txt}
{com}. 
. 
. ************************
. * realizations at m+3 **
. ************************
. * realized flow rate from m to m+3 and the expected rate at m
. 
. foreach rate in eurate_sa enrate_sa uerate_sa ///
>         unrate_sa nerate_sa nurate_sa urate_sa ///
>                 j2jrate_sa{c -(}
{txt}  2{com}. gen `rate'_r = f3.`rate'                
{txt}  3{com}. label var `rate'_r "realized rate next quarter"
{txt}  4{com}. {c )-}
{txt}(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)

{com}. 
. 
. ********************
. * times series plot
. *********************
. 
. keep if year>=2013
{txt}(72 observations deleted)

{com}. 
. *seperation rate
. 
. /*
> twoway (tsline exp_eu, lcolor(blue) lwidth(thick)) /// 
>        (tsline eurate_sa,yaxis(2) lcolor(red) lwidth(thick)), ///
>            ytitle("expected") ///
>            ytitle("realized", axis(2)) ///
>            legend(label(1 "expected") label(2 "realized (RHS)")) ///
>            title("expected and perceived seperation rate")
>            
> graph export "${c -(}graph_folder{c )-}/compare/seperation_rate.png", as(png) replace 
> 
> 
> * emp to non-labor force rate
> 
> twoway (tsline exp_en, lcolor(blue) lwidth(thick)) /// 
>        (tsline enrate_sa,yaxis(2) lcolor(red) lwidth(thick)), ///
>            ytitle("expected") ///
>            ytitle("realized", axis(2)) ///
>            legend(label(1 "expected") label(2 "realized (RHS)")) ///
>            title("expected and realized exit rate")
>            
> graph export "${c -(}graph_folder{c )-}/compare/exit_rate.png", as(png) replace 
> 
> * job to job rate
> twoway (tsline exp_ee_change, lcolor(blue) lwidth(thick)) /// 
>        (tsline j2jrate_sa,yaxis(2) lcolor(red) lwidth(thick)), ///
>            ytitle("expected") ///
>            ytitle("realized", axis(2)) ///
>            legend(label(1 "expected") label(2 "realized (RHS)")) ///
>            title("expected and realized job-to-job rate")
>            
> graph export "${c -(}graph_folder{c )-}/compare/j2j_rate.png", as(png) replace 
> */
. 
. * job finding rate
. twoway (tsline exp_ue, lcolor(blue) lwidth(thick)) /// 
>        (tsline uerate_sa,yaxis(2) lcolor(red) lwidth(thick)), ///
>            ytitle("expected") ///
>            ytitle("realized", axis(2)) ///
>            legend(label(1 "expected") label(2 "realized (RHS)")) ///
>            title("expected and realized job-finding rate")
{res}{txt}
{com}.            
. graph export "${c -(}graph_folder{c )-}/compare/j2j_rate.png", as(png) replace 
{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//compare/j2j_rate.png written in PNG format)

{com}. 
. 
{txt}end of do-file

{com}. clear

. do "/Users/Myworld/Dropbox/SearchMatchExpectation/code/SCE_CPS_compare.do"
{txt}
{com}. ****************************************************
. ***  This do files uses SCE individual labor market *
. *** survey to generate the aggregate perceived probability * 
. *** of different flow rates and compare it with CPS **
. **************************************** ************
. 
. 
. clear
{txt}
{com}. global mainfolder "/Users/Myworld/Dropbox/SearchMatchExpectation/"
{txt}
{com}. global folder "${c -(}mainfolder{c )-}/data/SCE"
{txt}
{com}. global graph_folder "${c -(}mainfolder{c )-}/graph/"
{txt}
{com}. *global sum_table_folder "${c -(}mainfolder{c )-}/tables"
. 
. cd ${c -(}folder{c )-}
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. pwd
{res}/Users/Myworld/Dropbox/SearchMatchExpectation/data/SCE
{txt}
{com}. set more off 
{txt}
{com}. 
. 
. /*
> ** reformat date in CPS data
> 
> use "${c -(}mainfolder{c )-}/workingdata/CPS_worker_flows.dta",clear
> generate date = dofc(tq)
> format date %td
> *gen year = year(date)
> *gen month = month(date)
> save "${c -(}mainfolder{c )-}/workingdata/CPS_worker_flows.dta",replace
> */
. 
. 
. use "${c -(}folder{c )-}/LaborExpSCEPopM.dta",clear
{txt}
{com}. merge 1:1 year month using "${c -(}mainfolder{c )-}/workingdata/CPS_worker_flows.dta",keep(master match using)
{res}{txt}{p 0 7 2}
(note: variable
year was 
int, now float to accommodate using data's values)
{p_end}

{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}              84
{txt}{col 9}from master{col 30}{res}               0{txt}  (_merge==1)
{col 9}from using{col 30}{res}              84{txt}  (_merge==2)

{col 5}matched{col 30}{res}              16{txt}  (_merge==3)
{col 5}{hline 41}

{com}. drop _merge 
{txt}
{com}. 
. *****************************
. *** generate monthly date
. *****************************
. gen date_str=string(year)+"m"+string(month)
{txt}
{com}. gen ymdate= monthly(date_str,"YM")
{txt}
{com}. format ymdate %tm
{txt}
{com}. drop date 
{txt}
{com}. rename ymdate date
{res}{txt}
{com}. tsset date
{res}{txt}{col 9}time variable:  {res}{col 25}date, 1995m1 to 2019m10, but with gaps
{txt}{col 17}delta:  {res}1 month
{txt}
{com}. 
. 
. ************************
. * realizations at m+3 **
. ************************
. * realized flow rate from m to m+3 and the expected rate at m
. 
. foreach rate in eurate_sa enrate_sa uerate_sa ///
>         unrate_sa nerate_sa nurate_sa urate_sa ///
>                 j2jrate_sa{c -(}
{txt}  2{com}. gen `rate'_r = f3.`rate'                
{txt}  3{com}. label var `rate'_r "realized rate next quarter"
{txt}  4{com}. {c )-}
{txt}(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)
(1 missing value generated)

{com}. 
. 
. ********************
. * times series plot
. *********************
. 
. keep if year>=2013
{txt}(72 observations deleted)

{com}. 
. *seperation rate
. 
. 
. twoway (tsline exp_eu, lcolor(blue) lwidth(thick)) /// 
>        (tsline eurate_sa,yaxis(2) lcolor(red) lwidth(thick)), ///
>            ytitle("expected") ///
>            ytitle("realized", axis(2)) ///
>            legend(label(1 "expected") label(2 "realized (RHS)")) ///
>            title("expected and perceived seperation rate")
{res}{txt}
{com}.            
. graph export "${c -(}graph_folder{c )-}/compare/seperation_rate.png", as(png) replace 
{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//compare/seperation_rate.png written in PNG format)

{com}. 
. 
. * emp to non-labor force rate
. 
. twoway (tsline exp_en, lcolor(blue) lwidth(thick)) /// 
>        (tsline enrate_sa,yaxis(2) lcolor(red) lwidth(thick)), ///
>            ytitle("expected") ///
>            ytitle("realized", axis(2)) ///
>            legend(label(1 "expected") label(2 "realized (RHS)")) ///
>            title("expected and realized exit rate")
{res}{txt}
{com}.            
. graph export "${c -(}graph_folder{c )-}/compare/exit_rate.png", as(png) replace 
{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//compare/exit_rate.png written in PNG format)

{com}. 
. * job to job rate
. twoway (tsline exp_ee_change, lcolor(blue) lwidth(thick)) /// 
>        (tsline j2jrate_sa,yaxis(2) lcolor(red) lwidth(thick)), ///
>            ytitle("expected") ///
>            ytitle("realized", axis(2)) ///
>            legend(label(1 "expected") label(2 "realized (RHS)")) ///
>            title("expected and realized job-to-job rate")
{res}{txt}
{com}.            
. graph export "${c -(}graph_folder{c )-}/compare/j2j_rate.png", as(png) replace 
{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//compare/j2j_rate.png written in PNG format)

{com}. 
. 
. * job finding rate
. twoway (tsline exp_ue, lcolor(blue) lwidth(thick)) /// 
>        (tsline uerate_sa,yaxis(2) lcolor(red) lwidth(thick)), ///
>            ytitle("expected") ///
>            ytitle("realized", axis(2)) ///
>            legend(label(1 "expected") label(2 "realized (RHS)")) ///
>            title("expected and realized job-finding rate")
{res}{txt}
{com}. graph export "${c -(}graph_folder{c )-}/compare/job_finding_rate.png", as(png) replace 
{txt}(file /Users/Myworld/Dropbox/SearchMatchExpectation//graph//compare/job_finding_rate.png written in PNG format)

{com}. 
. 
{txt}end of do-file

{com}. clear

. clear

. 